# 핸즈온 머신러닝 

## 3장. 분류



### 1. 교차검증

불균형한 데이터셋을 다룰때 ( 어떤 클래스가 다른것보다 월등히 많은 경우 )

=> 정화고를 분류기의 성능 측정지표로 선호하지않는다

cross_val_score() 함수



### 2. 오차행렬

cross_val_predict() 함수

k 겹 교차검증을 수행하지만 평가점수를 반환하지 않고 각 테스트 폴드에서 얻은 예측을 반환한다 

모든 훈련세트의 샘플에 대해 깨끗한 예측을 얻는다 ( 모델이 훈련하는 동안 보지 못한 데이터에 대해 예측)

confusion_matrix() 함수 

행 : 타깃클래스(실제 클래스) 와 열 : 예측클래스를 넣고 호출

완벽한 분류기라면 진짜 양성(TP) 과 진짜 음성(TN) => 행렬의 주대각선만 - 0이 아닌값이 된다

양성 예측의 정확도 - 분류기의 정밀도



**정밀도 TP / (TP + FP) = 진짜 양성 / ( 진짜 + 가짜 양성 )**

**(=민감도)**

**재현율 TP / TP + FN = 진짜 양성 / ( 진짜 양성 + 가짜 음성 )**

![ì ë°ë ì¬íì¨ ê³¡ì ì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://t1.daumcdn.net/cfile/tistory/2311A24D55B4FF7B1B)





FPR : 양성으로 잘못 분류된 음성 샘플 비율 (거짓양성비율)

TNR : 음성으로 정확하게 분류한 음성 샘플의 비율 (특이도)



### 3. tradeoff



decision func : 결정 임계치 지님 

decision_function() 메서드호출

=> 임계치를 높이면 재현율이 줄어든다 

cross_val_predict() 함수를 사용해 훈련 세트에 있는 모든 샘플의 점수를 구해

precision_recall_curve() 사용해 가능한 모든 임계치에 대해 정밀도와 재현율을 계산 



- **정밀도 / 재현율 곡선** ( 재현율 / 정밀도 )

재현율 80 근처에서 정밀도가 급격히 줄어든다 

이 강점 직전을 정밀도 재현율 TO로 선택하는 것이 좋다

즉, 재현율 60 지점

정밀도 90 % 달성이 목표라고 가정하고 

```python
y_train_pred_90 = (y_scores > 70000)
```

정밀도 90 달성한 분류기 _ 재현율이 너무 낮다면 높은 정밀도의 분류기는 전혀 유용하지않다 

재현율 ( TPR ) 이 높을수록 분류기가 만드는 거짓양성 ( FPR ) 이 늘어난다 

좋은 분류기 : 이 ROC 점선으로부터 최대한 멀리 떨어져야함  





- **수신기 조작특성 ( ROC )** ( 진짜 양성 비율 / 거짓 양성 비율)

= > 1 - 특이도 / 재현율( 민감도 )

roc_curve() 사용하여 여러 임계치에서 TPR , FPR 계산 

![ROC CURVEì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://miro.medium.com/max/1088/1*cktKLm3lw866qoVnnbqWIA.jpeg)

- decision func

scikit-learn 분류기에서 불확실성을 추정할 수 있는 함수가 두 개 있습니다. decision_function과 predict_proba입니다. 대부분의(전체는 아니고) 분류 클래스는 적어도 둘 중 하나를 제공하고 두 함수를 모두 제공하는 경우도 많습니다.

**즉, 임계값에 따라 재현율이 높아지면 정밀도가 줄어들고,정밀도가 높아지면 재현율이 줄어듭니다.**

![í¸ì¦ì¨ ë¨¸ì ë¬ë: ê²°ì  ìê³ê°ì ëí ì ë°ëì  ì¬íì¨](https://t1.daumcdn.net/cfile/tistory/9914B9455BE9536406)