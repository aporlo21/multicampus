# day 35 

## 머신러닝 프로젝트 방향 

### 구성 

1. 문제 정의 

- 목적 

ex ) 회원증가, 카드 매출 증대, 생산 비용 절감, 전력소비 최적화, 불량 원인 찾는 작업



2. 머신러닝을 사용하지 않는 방법 검토 ( 반드시 필요하진 않을수도 )

- [ 머신러닝 - 확률기반 ] => 자동 테스트 어려움... 데이터 의존관계 복잡
- 처리 파이프 라인 구조 복잡 [ 처리 -> 처리 ]



3. 시스템 설계

- 예측 결과를 어떻게 사용할 것인가
- 예측 오류의 영향 및 최소화 방법 고려 [ 예외 상황에대한 대처방안 고려 및 결정 ]
- 목표 성능, 포기 지점 설정



4. 알고리즘 선택

- 군진화 => 시각화 => 알고리즘 고민 



5. 특정 ( 수치 벡터 [30, 5, 3, ...] ) 내일 날씨 ?? 입력벡터

   로그 ( 기록 [시스템 로그] )

   설치 

- 특징 변환 : 흐림 (1), 맑음 (0)

범주 => 수치 ( 더미변수 ) : 라벨인코더. 원핫 인코더



6. 데이터 전처리

   이상치 처리, 정규화. 빈도가 낮은 단어 제거 

   더미변수화 잡음 제거

   

7. 학습 및 파라미터 튜닝

- overfitting 방지 [교차검증]

![data train validationì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://cdn-media-1.freecodecamp.org/images/augTyKVuV5uvIJKNnqUf3oR1K5n7E8DaqirO)

- 규제화
- 학습곡선



8. 시스템 통합과정

- 모니터링 시스템

기존의 시스템 에 병합



(1) 머신러닝시스템 " 문제해결"

- 확률 => 자동 테스트가 어렵다

예측성능 향상 =>  시스템복잡 => 유지보수 

시스템 변화 => 대응력이 높은 머신러닝 시스템 구축

- 예측모델 => 모듈화 => A/B 테스트 수행

- 1개 일때 more 알고리즘

- 여러 모델을 모듈화 => 병렬 테스트

  

   (2) 머신러닝 알고리즘 선택 방법 

  - 분류 : 클래스

  - 회귀 : 수치

  - 군집화

  - 차원 축소 

    

  - 추천

  - 이상탐지
  - 강화학습 : 정답이 명확하지 않은 환경에서 앞으로하게될 최적치 행동 선택 



- RNN project

RNN 작사 작곡.... 악보 data 필요

노래 악보 음표 .... 수치화 => 작사 모델 / 작

 모델



- 퍼셉트론 : 온라인 학습 방삭 [ data 1 개씩 ] _ 선형분리 가능, 문제 해결 간으 

<=> 배치 

- cost 함수 = (실제 - 예측 ) square



- 힌지 손실  ( hinge : 경첩 )

![íì§ ìì¤ì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://unsolvedproblem.github.io/assets/images/Hands-on/Ch5fig20.png)



- 규제화 

과적합 비선형 그래프 규제화를 통해 평탄화 시키는 것 



 합 .. .cost 함수값  + 규제항 

norm 벡터의 크기 ( 길이 )

Lp = 시그마 

![ê·ì í­ì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://slidesplayer.org/slide/16756235/97/images/39/5.3.2+%EA%B7%9C%EC%A0%9C%EC%9D%98+%EC%A0%95%EC%9D%98+%EA%B7%9C%EC%A0%9C%EB%8A%94+%EC%98%A4%EB%9E%98+%EC%A0%84%EB%B6%80%ED%84%B0+%EC%88%98%ED%95%99%EA%B3%BC+%ED%86%B5%EA%B3%84%ED%95%99%EC%97%90%EC%84%9C+%EC%97%B0%EA%B5%AC%ED%95%B4%EC%98%A8+%EC%A3%BC%EC%A0%9C.jpg)

- 유클리디안 거리 
- Support Vector Machine ( 마진 최대화 기법 )

![support vector machineì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://www.aitrends.com/wp-content/uploads/2018/01/1-19SVM-2.jpg)

- 커널 (kernal ) : 비선형 데이터 구분 가능 

![ì»¤ë ë¹ì í ë°ì´í° ë¶ë¦¬ê°ë¥ì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://image.slidesharecdn.com/svmv0-170619005336/95/svm-15-638.jpg?cb=1497833721)

- 신경망

비선형 data 분리 가능

시간 오래걸림

변수 가 많아지면, 과적합 발생 빈출 

가중치 초기값이 무엇이냐에 따라 굉장히 민감하다  



지역 최적점에서 멈춰버린다 

sol )  모멘텀 .. . 기울기를 따져서 가속도 와 같은 수치를 신경쓴다 



- knn 

k 값에 얼마를 주느냐 ... k 지점을 잘 찾는게 성능의 주요 issue 



(3) 분류 결과 

- 정밀도, 재현율 , f 측정값, 정확도
- 정확도 = 정답 일치 data / 전체 data
- 정밀도 ( prediction ) = 분류기 => 스팸으로 판정한 메일 중, 진짜 스팸의 비율

ex_ 전체 메일 : 100,  판정 스팸 : 80, 분류(실제)스팸 : 60 => 60 / 80

- 재현율 ( recall )

- 판정값 실제 스팸 : 60, 분류기가 스팸으로 분류 50 => 분류기가 스팸으로 분류 : 50 / 60
- f - score : 정밀도 와 재현율의 조화

값이 크게 나올수록 prediction & recall Value 가 둘다 높다 



1. 평균제곱오차 ( RMSE )

![rmseì ëí ì´ë¯¸ì§ ê²ìê²°ê³¼](https://4.bp.blogspot.com/-wG7IbjTfE6k/XGUvqm7TCVI/AAAAAAAAAZU/vpH1kuKTIooKTcVlnm1EVRCXLVZM9cPNgCLcBGAs/s1600/formula-MAE-MSE-RMSE-RSquared.JPG)

ref )  y : 실제값 



2. 결정계수 

Q) 항상 평균을 출력하는 예측 모델보다 성능이 더 좋나? 

1에 가까울수록 좋고 0 에 가까울수록 안좋다 



VGG 16 _ 네트워크 ,.,, pc 환경에서 이루어낼수 없어 

VGG 19



**릿지 회귀**



릿지 회귀는 L2-Norm을 사용한 회귀입니다. 이 회귀방법은 일반적으로 영향을 거의 미치지 않는 특성에 대하여 0에 가까운 가중치를 주게 됩니다. 

![img](https://t1.daumcdn.net/cfile/tistory/99BE24355C90F8522D)



**라쏘 회귀**

라쏘 회귀는 L1-Norm을 사용한 회귀입니다. 특성값의 계수가 매우 낮다면 0으로 수렴하게 하여 특성을 지워버립니다. 특성이 모델에 미치는 영향을 0으로 만든다는 것은 bias를 증가 시켜 overfitting을 방지한다는 의미가 되겠죠?

![img](https://t1.daumcdn.net/cfile/tistory/99B45E355C90F8532C)



**엘라스틱넷**

엘라스틱 넷은 라쏘회귀와 릿지회귀의 최적화 지점이 서로 다르기 때문에 두 정규화 항을 합쳐서 r로 규제정도를 조절하여 준다.



![img](https://t1.daumcdn.net/cfile/tistory/99DFDF355C90F8532C)



밑의 그림을 보면, L1-Norm을 사용한 것은 마름모꼴이 되면서 가중치 중 하나가 0이 되는 걸 볼 수 있다.

그에 반해, L2-Norm은 두 가중치를 서서히 줄어들게 해서 작은 수의 가중치를 가지는 것을 볼 수 있다.



